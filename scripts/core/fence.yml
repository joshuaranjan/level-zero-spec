--- #--------------------------------------------------------------------------
type: header
desc: "Intel $Xx Driver APIs for Fence"
--- #--------------------------------------------------------------------------
type: macro
desc: "API version of $x_fence_desc_t"
name: $X_FENCE_DESC_VERSION
value: "$X_MAKE_VERSION( 1, 0 )"
--- #--------------------------------------------------------------------------
type: enum
desc: "Supported fence creation flags"
name: $x_fence_flag_t
etors:
    - name: $X_FENCE_FLAG_NONE
      value: "0"
      desc: "default behavior"
--- #--------------------------------------------------------------------------
type: struct
desc: "Fence descriptor"
name: $x_fence_desc_t
members:
    - type: uint32_t
      name: version
      desc: "[in] descriptor version"
    - type: $x_fence_flag_t
      name: flags
      desc: "[in] creation flags"
--- #--------------------------------------------------------------------------
type: function
desc: "Creates a fence object on the device's command queue."
class: $xCommandQueue
name: CreateFence
analogue:
    - "**vkCreateFence**"
details:
    - "The application may call this function from simultaneous threads."
    - "The implementation of this function should be lock-free."
params:
    - type: $x_command_queue_handle_t
      name: hCommandQueue
      desc: "[in] handle of command queue"
    - type: "const $x_fence_desc_t*"
      name: desc
      desc: "[in] pointer to fence descriptor"
    - type: "$x_fence_handle_t*"
      name: phFence
      desc: "[out] pointer to handle of fence object created"
returns:
    - $X_RESULT_ERROR_OUT_OF_HOST_MEMORY
    - $X_RESULT_ERROR_OUT_OF_DEVICE_MEMORY
--- #--------------------------------------------------------------------------
type: function
desc: "Deletes a fence object."
class: $xFence
name: Destroy
details:
    - "The application is responsible for making sure the GPU is not currently referencing the fence before it is deleted"
    - "The implementation of this function will immediately free all Host and Device allocations associated with this fence"
    - "The implementation of this function should be lock-free."
analogue:
    - "**vkDestroyFence**"
params:
    - type: $x_fence_handle_t
      name: hFence
      desc: "[in] handle of fence object to destroy"
returns:
    - $X_RESULT_ERROR_INVALID_PARAMETER:
        - "fence is enqueued in a command queue"
--- #--------------------------------------------------------------------------
type: function
desc: "The current host thread waits on a fence to be signaled."
class: $xHost
name: WaitOnFence
analogue:
    - "**vkWaitForFences**"
details:
    - "The application may call this function from simultaneous threads."
    - "The implementation of this function should be lock-free."
params:
    - type: $x_fence_handle_t
      name: hFence
      desc: "[in] handle of the fence"
    - type: $x_synchronization_mode_t
      name: mode
      desc: "[in] synchronization mode"
    - type: uint32_t
      name: delay
      desc: "[in] if $X_SYNCHRONIZATION_MODE_SLEEP == mode, then time (in microseconds) to poll before putting Host thread to sleep; 
            otherwise, must be zero."
    - type: uint32_t
      name: interval
      desc: "[in] if $X_SYNCHRONIZATION_MODE_SLEEP == mode, then maximum time (in microseconds) to put Host thread to sleep between polling;
            otherwise, must be zero."
    - type: uint32_t
      name: timeout
      desc: "[in] if non-zero, then indicates the maximum time to poll or sleep before returning;
            if zero, then only a single status check is made before immediately returning;
            if MAX_UINT32, then function will not return until complete."
returns:
    - $X_RESULT_NOT_READY:
       - "timeout expired"
    - $X_RESULT_ERROR_INVALID_PARAMETER:
        - "fence is not enqueued in a command queue"
--- #--------------------------------------------------------------------------
type: function
desc: "The current host thread waits on a multiple fences to be signaled."
class: $xHost
name: WaitOnMultipleFences
analogue:
    - "**vkWaitForFences**"
details:
    - "The application may call this function from simultaneous threads."
    - "The implementation of this function should be lock-free."
params:
    - type: uint32_t
      name: numFences
      desc: "[in] number of fences in hFences"
    - type: "$x_fence_handle_t*"
      name: phFences
      desc: "[in] pointer to array of handles of the fences"
    - type: $x_synchronization_mode_t
      name: mode
      desc: "[in] synchronization mode"
    - type: uint32_t
      name: delay
      desc: "[in] if $X_SYNCHRONIZATION_MODE_SLEEP == mode, then time (in microseconds) to poll before putting Host thread to sleep; 
            otherwise, must be zero."
    - type: uint32_t
      name: interval
      desc: "[in] if $X_SYNCHRONIZATION_MODE_SLEEP == mode, then maximum time (in microseconds) to put Host thread to sleep between polling;
            otherwise, must be zero."
    - type: uint32_t
      name: timeout
      desc: "[in] if non-zero, then indicates the maximum time to poll or sleep before returning;
            if zero, then only a single status check is made before immediately returning;
            if MAX_UINT32, then function will not return until complete."
returns:
    - $X_RESULT_NOT_READY:
       - "timeout expired"
    - $X_RESULT_ERROR_INVALID_PARAMETER:
        - "nullptr == any handle in phFences"
        - "any fence is not enqueued in a command queue"
--- #--------------------------------------------------------------------------
type: function
desc: "Queries a fence object's status."
class: $xFence
name: QueryStatus
analogue:
    - "**vkGetFenceStatus**"
details:
    - "The application may call this function from simultaneous threads."
    - "The implementation of this function should be lock-free."
params:
    - type: $x_fence_handle_t
      name: hFence
      desc: "[in] handle of the fence"
returns:
    - $X_RESULT_NOT_READY:
        - not signaled
    - $X_RESULT_ERROR_INVALID_PARAMETER:
        - "fence is not enqueued in a command queue"
--- #--------------------------------------------------------------------------
type: function
desc: "Queries the elapsed time between two signaled fences."
class: $x
name: FenceQueryElapsedTime
details:
    - "The application may call this function from simultaneous threads."
    - "The implementation of this function should be lock-free."
params:
    - type: $x_fence_handle_t
      name: hFenceStart
      desc: "[in] handle of the fence"
    - type: $x_fence_handle_t
      name: hFenceEnd
      desc: "[in] handle of the fence"
    - type: "double_t*"
      name: pTime
      desc: "[out] time in milliseconds"
returns:
    - $X_RESULT_ERROR_INVALID_PARAMETER:
        - "either fence not enqueued"
--- #--------------------------------------------------------------------------
type: function
desc: "Reset a fence back to the not signaled state."
class: $xFence
name: Reset
analogue:
    - "**vkResetFences**"
details:
    - "The application may call this function from simultaneous threads."
    - "The implementation of this function should be lock-free."
params:
    - type: $x_fence_handle_t
      name: hFence
      desc: "[in] handle of the fence"
--- #--------------------------------------------------------------------------
type: class
desc: "C++ wrapper for fence"
name: $xFence
members:
    - type: $x_fence_handle_t
      name: handle
      desc: "handle of fence object"
    - type: $x_fence_desc_t
      name: desc
      desc: "descriptor of the fence object"
